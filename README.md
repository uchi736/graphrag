# Graph-RAG with Streamlit UI

æœ€æ–°ç‰ˆã®LangChain APIã«å¯¾å¿œã—ãŸã€Graph-RAGã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨å®Ÿè£…ã§ã™ã€‚
**Streamlit UI**ã‚’æ­è¼‰ã—ã€PDF/ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‡ªå‹•çš„ã«ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ã‚’æ§‹ç¯‰ãƒ»å¯è¦–åŒ–ã§ãã¾ã™ã€‚

![Graph-RAG Demo](https://img.shields.io/badge/Python-3.8+-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

## ğŸŒŸ ä¸»ãªæ©Ÿèƒ½

### âœ¨ Streamlit WebUI
- ğŸ“ **PDF/ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**: ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ç°¡å˜ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- ğŸš€ **ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•æ§‹ç¯‰**: LLMãŒè‡ªå‹•çš„ã«ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æŠ½å‡º
- ğŸ”„ **æ—¢å­˜ã‚°ãƒ©ãƒ•ã®è‡ªå‹•æ¤œå‡º**: Neo4jã«æ—¢ã«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Œã°å³åº§ã«å¾©å…ƒ
- ğŸ’¬ **å¯¾è©±å‹è³ªå•å¿œç­”**: Graph-RAGæŠ€è¡“ã«ã‚ˆã‚‹é«˜ç²¾åº¦ãªå›ç­”ç”Ÿæˆ

### ğŸ¨ é«˜åº¦ãªã‚°ãƒ©ãƒ•å¯è¦–åŒ–
- **2ã¤ã®å¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³**:
  - **Streamlit-Agraph** (æ¨å¥¨): è»½é‡ã§ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–
  - **Pyvis** (è©³ç´°): é«˜åº¦ãªç‰©ç†ã‚¨ãƒ³ã‚¸ãƒ³è¨­å®š
- **ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—è‡ªå‹•åˆ¤å®š**: äººç‰©ã€å ´æ‰€ã€ã‚¤ãƒ™ãƒ³ãƒˆã€ç‰©ãªã©ã‚’è‡ªå‹•åˆ†é¡
- **ã‚¿ã‚¤ãƒ—åˆ¥è‰²åˆ†ã‘**: è¦–è¦šçš„ã«ã‚ã‹ã‚Šã‚„ã™ã„ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
- **æ¥ç¶šæ•°ã«å¿œã˜ãŸãƒãƒ¼ãƒ‰ã‚µã‚¤ã‚º**: é‡è¦ãªã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãŒä¸€ç›®ã§ã‚ã‹ã‚‹
- **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**: ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—åˆ¥ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ

### ğŸ§  æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **LLMGraphTransformer**: GPT-4ã‚’ä½¿ç”¨ã—ãŸã‚°ãƒ©ãƒ•å¤‰æ›
- **Neo4j**: ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **PGVector**: ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆPostgreSQLï¼‰
- **Azure OpenAI**: LLMã¨Embedding
- **SemanticChunker**: æ„å‘³çš„ãªãƒ†ã‚­ã‚¹ãƒˆåˆ†å‰²
- **LCEL**: ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ãƒã‚§ã‚¤ãƒ³

## ğŸ“‹ å¿…è¦ãªç’°å¢ƒ

- Python 3.8ä»¥ä¸Š
- Neo4j Aura (ã¾ãŸã¯ãƒ­ãƒ¼ã‚«ãƒ«Neo4jã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹)
- PostgreSQL with PGVectoræ‹¡å¼µ
- Azure OpenAI API ã‚­ãƒ¼

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/uchi736/graphrag.git
cd graphrag
```

### 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install -r requirements.txt
```

### 3. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä½œæˆ:

```env
# Neo4j Configuration
NEO4J_URI=neo4j+s://xxxxx.databases.neo4j.io
NEO4J_USER=neo4j
NEO4J_PW=your_neo4j_password

# PostgreSQL Configuration
PG_CONN=postgresql+psycopg://postgres:your_password@your-host:5432/postgres

# Azure OpenAI Service Settings
AZURE_OPENAI_API_KEY=your_azure_openai_api_key
AZURE_OPENAI_ENDPOINT=https://your-endpoint.openai.azure.com
AZURE_OPENAI_API_VERSION=2024-12-01-preview
AZURE_OPENAI_CHAT_DEPLOYMENT_NAME=gpt-4o
AZURE_OPENAI_EMBEDDING_DEPLOYMENT_NAME=text-embedding-3-small
```

### 4. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•

```bash
streamlit run app.py
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:8501` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚

## ğŸ“– ä½¿ã„æ–¹

### åˆå›åˆ©ç”¨æ™‚

1. **PDFã¾ãŸã¯ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**
   - è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®åŒæ™‚ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯èƒ½
   - ã‚µãƒãƒ¼ãƒˆå½¢å¼: PDF, TXT

2. **ã€ŒğŸš€ ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ã‚’æ§‹ç¯‰ã€ã‚’ã‚¯ãƒªãƒƒã‚¯**
   - è‡ªå‹•çš„ã«ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æŠ½å‡º
   - Neo4jã¨PGVectorã«ä¿å­˜

3. **è³ªå•ã‚’å…¥åŠ›**
   - ã‚°ãƒ©ãƒ•ã¨ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã‚’çµ„ã¿åˆã‚ã›ãŸé«˜ç²¾åº¦ãªå›ç­”

4. **ã‚°ãƒ©ãƒ•ã‚’å¯è¦–åŒ–**
   - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ãƒãƒ¼ãƒ‰ã¨ã‚¨ãƒƒã‚¸ã‚’æ¢ç´¢
   - ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§çµã‚Šè¾¼ã¿å¯èƒ½

### 2å›ç›®ä»¥é™

æ—¢ã«Neo4jã«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆ:
- ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«è‡ªå‹•æ¤œå‡º
- **ã€ŒğŸ”„ æ—¢å­˜ã‚°ãƒ©ãƒ•ã‚’èª­ã¿è¾¼ã‚€ã€ã‚’ã‚¯ãƒªãƒƒã‚¯**ã™ã‚‹ã ã‘ã§å³åº§ã«åˆ©ç”¨å¯èƒ½
- å†æ§‹ç¯‰ä¸è¦ï¼

## ğŸ¯ ã‚µã‚¤ãƒ‰ãƒãƒ¼æ©Ÿèƒ½

### ğŸ“Š ã‚°ãƒ©ãƒ•å¯è¦–åŒ–è¨­å®š
- **å¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³é¸æŠ**: Agraph / Pyvis
- **æœ€å¤§è¡¨ç¤ºãƒãƒ¼ãƒ‰æ•°**: 50ã€œ500å€‹
- **ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**:
  - ğŸ‘¤ äººç‰© (Person)
  - ğŸï¸ å ´æ‰€ (Place)
  - âš¡ ã‚¤ãƒ™ãƒ³ãƒˆ (Event)
  - ğŸ“¦ ç‰© (Object)
  - â“ ãã®ä»– (Other)

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
PDF/Text â†’ SemanticChunker â†’ LLMGraphTransformer
                                      â†“
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â†“                   â†“
                         Neo4j              PGVector
                      (ã‚°ãƒ©ãƒ•DB)          (ãƒ™ã‚¯ãƒˆãƒ«DB)
                            â†“                   â†“
                    GraphRetriever      VectorRetriever
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â†“
                               Context Merge
                                      â†“
                                  Azure OpenAI
                                      â†“
                                    å›ç­”ç”Ÿæˆ
```

## ğŸ”§ æŠ€è¡“çš„ãªè©³ç´°

### Neo4j Cypherã‚¯ã‚¨ãƒª
Neo4j 5.xä»¥é™ã®æ–°ã—ã„æ§‹æ–‡ã«å¯¾å¿œ:
```cypher
MATCH (n)-[r]->(m)
WITH n, r, m, labels(n) as source_labels, labels(m) as target_labels
RETURN
  n.id AS source,
  type(r) AS relation,
  m.id AS target,
  COUNT { (n)--() } AS source_degree,
  COUNT { (m)--() } AS target_degree
LIMIT 200
```

### å¯è¦–åŒ–ã®ç‰¹å¾´
- **ãƒãƒ¼ãƒ‰ã‚µã‚¤ã‚º**: æ¥ç¶šæ•°ã«å¿œã˜ã¦è‡ªå‹•èª¿æ•´ï¼ˆæœ€å°10ã€æœ€å¤§60ï¼‰
- **ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰**:
  - ğŸ”´ äººç‰©: `#FF6B6B`
  - ğŸ”µ å ´æ‰€: `#4ECDC4`
  - ğŸŸ¢ ã‚¤ãƒ™ãƒ³ãƒˆ: `#95E1D3`
  - ğŸŸ¡ ç‰©: `#FFE66D`
  - âšª ãã®ä»–: `#95A5A6`

## ğŸ“¦ ä¸»è¦ãªä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

```
streamlit>=1.28.0
langchain-core>=0.1.0
langchain-openai>=0.1.0
langchain-experimental>=0.1.0
neo4j>=5.20.0
pypdf>=3.17.0
streamlit-agraph>=0.0.45
pyvis>=0.3.2
networkx>=3.0
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œãªã„
- `streamlit-agraph`ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- Pyvisã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª

### Neo4jæ¥ç¶šã‚¨ãƒ©ãƒ¼
- `.env`ã®`NEO4J_URI`ãŒæ­£ã—ã„ã‹ç¢ºèª
- Neo4j Auraã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª

### PGVectoræ¥ç¶šã‚¨ãƒ©ãƒ¼
- PostgreSQLã«PGVectoræ‹¡å¼µãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- `PG_CONN`ã®æ¥ç¶šæ–‡å­—åˆ—ãŒæ­£ã—ã„ã‹ç¢ºèª

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ­“è¿ã—ã¾ã™ï¼

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License - è©³ç´°ã¯ [LICENSE](LICENSE) ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸ™ è¬è¾

- [LangChain](https://github.com/langchain-ai/langchain)
- [Neo4j](https://neo4j.com/)
- [Streamlit](https://streamlit.io/)
- [Streamlit-Agraph](https://github.com/ChrisDelClea/streamlit-agraph)
- [Pyvis](https://github.com/WestHealth/pyvis)

## ğŸ“§ ãŠå•ã„åˆã‚ã›

è³ªå•ã‚„ææ¡ˆãŒã‚ã‚‹å ´åˆã¯ã€[Issues](https://github.com/uchi736/graphrag/issues)ã§ãŠæ°—è»½ã«ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚

---

**âš¡ Built with LangChain, Neo4j, PGVector & Azure OpenAI**
